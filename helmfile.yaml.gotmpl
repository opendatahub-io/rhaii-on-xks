# llm-d-infra-xks - Infrastructure for llm-d on xKS (AKS/EKS/GKE)
#
# Usage:
#   helmfile apply                                        # Deploy all operators
#   helmfile apply --selector name=cert-manager-operator  # Deploy only cert-manager
#   helmfile apply --selector name=sail-operator          # Deploy only istio
#   helmfile apply --selector name=lws-operator           # Deploy only lws
#   helmfile destroy                                      # Remove all

environments:
  default:
    values:
      - values.yaml

---

# Import operator helmfiles from GitHub
# Note: selectorsInherited=true ensures parent --selector flag filters child releases
helmfiles:
  # cert-manager operator
  - path: git::https://github.com/aneeshkp/cert-manager-operator-chart.git@helmfile.yaml.gotmpl?ref=main
    selectorsInherited: true
    values:
      - useSystemPodmanAuth: {{ .Values.useSystemPodmanAuth | default true }}
      - pullSecretFile: {{ .Values.pullSecretFile | default "" | quote }}

  # sail-operator (Istio) - using release-3.1 for v1alpha2 stack
  - path: git::https://github.com/aneeshkp/sail-operator-chart.git@helmfile.yaml.gotmpl?ref=release-3.1
    selectorsInherited: true
    values:
      - useSystemPodmanAuth: {{ .Values.useSystemPodmanAuth | default true }}
      - pullSecretFile: {{ .Values.pullSecretFile | default "" | quote }}

  # lws-operator
  - path: git::https://github.com/aneeshkp/lws-operator-chart.git@helmfile.yaml.gotmpl?ref=main
    selectorsInherited: true
    values:
      - useSystemPodmanAuth: {{ .Values.useSystemPodmanAuth | default true }}
      - pullSecretFile: {{ .Values.pullSecretFile | default "" | quote }}
